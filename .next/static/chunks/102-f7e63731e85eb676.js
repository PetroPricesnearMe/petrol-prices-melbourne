(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[102],{2226:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let a=n(4232),r=a.useLayoutEffect,o=a.useEffect;function i(e){let{headManager:t,reduceComponentsToState:n}=e;function i(){if(t&&t.mountedInstances){let r=a.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(n(r,e))}}return r(()=>{var n;return null==t||null==(n=t.mountedInstances)||n.add(e.children),()=>{var n;null==t||null==(n=t.mountedInstances)||n.delete(e.children)}}),r(()=>(t&&(t._pendingUpdate=i),()=>{t&&(t._pendingUpdate=i)})),o(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},3169:(e,t)=>{"use strict";function n(e){let{ampFirst:t=!1,hybrid:n=!1,hasQuery:a=!1}=void 0===e?{}:e;return t||n&&a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return n}})},4461:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return a}});let a=n(4252)._(n(4232)).default.createContext({})},5875:(e,t,n)=>{"use strict";n.d(t,{oe:()=>p});var a=n(3576),r=n(2701),o=n(5364);let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!window.gtag)return;window.gtag("event",e,(0,r._)((0,a._)({},t),{send_to:o.env.REACT_APP_GA_MEASUREMENT_ID}))}catch(e){}};var s=n(5364);let l={SEARCH_PERFORMED:"search_performed",FILTER_APPLIED:"filter_applied",STATION_VIEWED:"station_viewed",STATION_CLICKED:"station_clicked",DIRECTIONS_CLICKED:"directions_clicked",PHONE_CLICKED:"phone_clicked",PAGE_VIEW:"page_view",SESSION_END:"session_end",TIME_ON_PAGE:"time_on_page"};class d{generateSessionId(){return"session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}loadFromStorage(){if("undefined"!=typeof localStorage)try{let e=localStorage.getItem("ppnm_analytics");if(e){let t=JSON.parse(e);this.events=t.events||[]}}catch(e){console.warn("Failed to load analytics from storage:",e)}}saveToStorage(){if("undefined"!=typeof localStorage)try{let e={events:this.events.slice(-1e3),lastUpdated:Date.now()};localStorage.setItem("ppnm_analytics",JSON.stringify(e))}catch(e){console.warn("Failed to save analytics to storage:",e)}}trackEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let n={id:"event_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:e,timestamp:Date.now(),sessionId:this.sessionId,data:t,page:window.location.pathname,userAgent:navigator.userAgent};this.events.push(n),this.saveToStorage(),this.sendToExternalAnalytics(n)}catch(e){}}sendToExternalAnalytics(e){try{i(e.type,(0,a._)({event_category:this.getCategoryFromEventType(e.type),event_label:e.data.query||e.data.stationId||e.data.filterType||"unknown",value:e.data.value||0,session_id:this.sessionId,page_path:window.location.pathname},e.data))}catch(e){}try{window.fbq&&window.fbq("trackCustom",e.type,e.data)}catch(e){}s.env.REACT_APP_ANALYTICS_ENDPOINT&&fetch(s.env.REACT_APP_ANALYTICS_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch(e=>console.warn("Analytics endpoint error:",e))}getCategoryFromEventType(e){return({[l.SEARCH_PERFORMED]:"Search",[l.FILTER_APPLIED]:"Filter",[l.STATION_CLICKED]:"Engagement",[l.DIRECTIONS_CLICKED]:"Conversion",[l.PAGE_VIEW]:"Navigation"})[e]||"Other"}generateReport(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"7days",t=Date.now(),n={"24hours":864e5,"7days":6048e5,"30days":2592e6},a=t-(n[e]||n["7days"]),r=this.events.filter(e=>e.timestamp>=a);return{timeRange:e,totalEvents:r.length,uniqueSessions:new Set(r.map(e=>e.sessionId)).size,eventBreakdown:this.getEventBreakdown(r),topSearches:this.getTopSearches(r),topStations:this.getTopStations(r),conversionRate:this.calculateConversionRate(r),avgTimeOnPage:this.calculateAvgTimeOnPage(r),popularFilters:this.getPopularFilters(r)}}getEventBreakdown(e){let t={};return e.forEach(e=>{t[e.type]=(t[e.type]||0)+1}),t}getTopSearches(e){let t=e.filter(e=>e.type===l.SEARCH_PERFORMED).map(e=>e.data.query).filter(Boolean),n={};return t.forEach(e=>{n[e]=(n[e]||0)+1}),Object.entries(n).sort((e,t)=>t[1]-e[1]).slice(0,10).map(e=>{let[t,n]=e;return{query:t,count:n}})}getTopStations(e){let t=e.filter(e=>e.type===l.STATION_VIEWED).map(e=>e.data.stationId).filter(Boolean),n={};return t.forEach(e=>{n[e]=(n[e]||0)+1}),Object.entries(n).sort((e,t)=>t[1]-e[1]).slice(0,10).map(e=>{let[t,n]=e;return{stationId:t,views:n}})}calculateConversionRate(e){let t=e.filter(e=>e.type===l.STATION_VIEWED).length,n=e.filter(e=>e.type===l.DIRECTIONS_CLICKED||e.type===l.PHONE_CLICKED).length;return t>0?(n/t*100).toFixed(2):0}calculateAvgTimeOnPage(e){let t=e.filter(e=>e.type===l.TIME_ON_PAGE);return 0===t.length?0:Math.round(t.reduce((e,t)=>e+(t.data.duration||0),0)/t.length/1e3)}getPopularFilters(e){let t=e.filter(e=>e.type===l.FILTER_APPLIED).map(e=>e.data.filterType).filter(Boolean),n={};return t.forEach(e=>{n[e]=(n[e]||0)+1}),Object.entries(n).sort((e,t)=>t[1]-e[1]).map(e=>{let[t,n]=e;return{filter:t,count:n}})}exportToCSV(){if("undefined"==typeof document)return;let e=new Blob([[["Timestamp","Event Type","Session ID","Page","Data"],...this.events.map(e=>[new Date(e.timestamp).toISOString(),e.type,e.sessionId,e.page,JSON.stringify(e.data)])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="analytics_".concat(Date.now(),".csv"),n.click(),URL.revokeObjectURL(t)}clearData(){this.events=[],"undefined"!=typeof localStorage&&localStorage.removeItem("ppnm_analytics")}constructor(){this.events=[],this.sessionId=this.generateSessionId(),this.sessionStartTime=Date.now(),this.loadFromStorage(),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&this.trackEvent(l.SESSION_END,{duration:Date.now()-this.sessionStartTime,reason:"visibility_hidden"})}),window.addEventListener("pagehide",()=>{this.trackEvent(l.SESSION_END,{duration:Date.now()-this.sessionStartTime,reason:"page_hide"})})}}let c=new d,u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{c.trackEvent(e,t)}catch(e){}},p=e=>{try{u(l.PAGE_VIEW,{pageName:e})}catch(e){}}},7328:(e,t,n)=>{e.exports=n(9269)},9269:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return _},defaultHead:function(){return u}});let a=n(4252),r=n(8365),o=n(7876),i=r._(n(4232)),s=a._(n(2226)),l=n(4461),d=n(7965),c=n(3169);function u(e){void 0===e&&(e=!1);let t=[(0,o.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function p(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===i.default.Fragment?e.concat(i.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}n(6201);let f=["name","httpEquiv","charSet","itemProp"];function h(e,t){let{inAmpMode:n}=t;return e.reduce(p,[]).reverse().concat(u(n).reverse()).filter(function(){let e=new Set,t=new Set,n=new Set,a={};return r=>{let o=!0,i=!1;if(r.key&&"number"!=typeof r.key&&r.key.indexOf("$")>0){i=!0;let t=r.key.slice(r.key.indexOf("$")+1);e.has(t)?o=!1:e.add(t)}switch(r.type){case"title":case"base":t.has(r.type)?o=!1:t.add(r.type);break;case"meta":for(let e=0,t=f.length;e<t;e++){let t=f[e];if(r.props.hasOwnProperty(t))if("charSet"===t)n.has(t)?o=!1:n.add(t);else{let e=r.props[t],n=a[t]||new Set;("name"!==t||!i)&&n.has(e)?o=!1:(n.add(e),a[t]=n)}}}return o}}()).reverse().map((e,t)=>{let n=e.key||t;return i.default.cloneElement(e,{key:n})})}let _=function(e){let{children:t}=e,n=(0,i.useContext)(l.AmpStateContext),a=(0,i.useContext)(d.HeadManagerContext);return(0,o.jsx)(s.default,{reduceComponentsToState:h,headManager:a,inAmpMode:(0,c.isInAmpMode)(n),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}}]);