(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[985],{413:(e,a,t)=>{"use strict";t.d(a,{Io:()=>i,Q$:()=>c,Uu:()=>r,cm:()=>o,rL:()=>n,sF:()=>l});var s=t(8556);let r=s.P.div,l=s.P.h1,n=s.P.p,i=s.P.section;s.P.article;let o={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.6,staggerChildren:.1}}},c={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6}}}},2404:(e,a,t)=>{"use strict";t.r(a),t.d(a,{__N_SSG:()=>P,default:()=>D});var s=t(7876),r=t(4232),l=t(9099),n=t(7328),i=t.n(n),o=t(8230),c=t.n(o),d=t(413),u=t(3422),h=t(3576),m=t(2701);let p=e=>{let{onFilterChange:a,stations:t=[],activeFilters:l={}}=e,[n,i]=(0,r.useState)(!1),[o,c]=(0,r.useState)(l.search||""),[d,u]=(0,r.useState)(l.fuelType||"all"),[p,g]=(0,r.useState)(l.brand||"all"),[b,f]=(0,r.useState)(l.priceRange||{min:"",max:""}),[v,x]=(0,r.useState)(l.sortBy||"name"),[y,N]=(0,r.useState)(l.region||"all"),S=["all",...new Set(t.flatMap(e=>{var a;return(null==(a=e.fuelPrices)?void 0:a.map(e=>e.fuelType))||[]}))].filter(Boolean),j=["all",...new Set(t.map(e=>e.brand).filter(Boolean))];(0,r.useEffect)(()=>{a({search:o,fuelType:d,brand:p,priceRange:b,sortBy:v,region:y})},[o,d,p,b,v,y,a]);let C=[o,"all"!==d,"all"!==p,b.min||b.max,"all"!==y].filter(Boolean).length;return(0,s.jsxs)("div",{className:"advanced-filters",children:[(0,s.jsxs)("div",{className:"filter-search-container",children:[(0,s.jsxs)("div",{className:"search-input-wrapper",children:[(0,s.jsx)("span",{className:"search-icon","aria-hidden":"true",children:"\uD83D\uDD0D"}),(0,s.jsx)("input",{type:"search",name:"station-search",className:"filter-search-input",placeholder:"Search by station name, address, suburb...",value:o,onChange:e=>c(e.target.value),"aria-label":"Search stations"}),o&&(0,s.jsx)("button",{className:"clear-search-btn",onClick:()=>c(""),"aria-label":"Clear search",children:"✕"})]}),(0,s.jsxs)("button",{className:"toggle-filters-btn ".concat(n?"active":""),onClick:()=>i(!n),"aria-expanded":n,"aria-controls":"filter-panel",children:[(0,s.jsx)("span",{className:"filter-icon","aria-hidden":"true",children:"⚙️"}),"Filters",C>0&&(0,s.jsx)("span",{className:"filter-badge","aria-label":"".concat(C," filters active"),children:C})]})]}),n&&(0,s.jsxs)("div",{id:"filter-panel",className:"filter-panel",role:"region","aria-label":"Filter options",children:[(0,s.jsxs)("div",{className:"filter-grid",children:[(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"fuel-type-filter",className:"filter-label",children:"⛽ Fuel Type"}),(0,s.jsxs)("select",{id:"fuel-type-filter",name:"fuel-type-filter",className:"filter-select",value:d,onChange:e=>u(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Fuel Types"}),S.filter(e=>"all"!==e).map(e=>(0,s.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"brand-filter",className:"filter-label",children:"\uD83C\uDFEA Brand"}),(0,s.jsxs)("select",{id:"brand-filter",name:"brand-filter",className:"filter-select",value:p,onChange:e=>g(e.target.value),children:[(0,s.jsx)("option",{value:"all",children:"All Brands"}),j.filter(e=>"all"!==e).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"region-filter",className:"filter-label",children:"\uD83D\uDCCD Region"}),(0,s.jsx)("select",{id:"region-filter",name:"region-filter",className:"filter-select",value:y,onChange:e=>N(e.target.value),children:["all","North Melbourne","South Melbourne","East Melbourne","West Melbourne","CBD"].map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Regions":e},e))})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"sort-filter",className:"filter-label",children:"\uD83D\uDD04 Sort By"}),(0,s.jsxs)("select",{id:"sort-filter",name:"sort-filter",className:"filter-select",value:v,onChange:e=>x(e.target.value),children:[(0,s.jsx)("option",{value:"name",children:"Name (A-Z)"}),(0,s.jsx)("option",{value:"price-low",children:"Price (Low to High)"}),(0,s.jsx)("option",{value:"price-high",children:"Price (High to Low)"}),(0,s.jsx)("option",{value:"distance",children:"Distance (Nearest)"}),(0,s.jsx)("option",{value:"updated",children:"Recently Updated"})]})]}),(0,s.jsxs)("div",{className:"filter-group filter-group-wide",children:[(0,s.jsx)("label",{className:"filter-label",children:"\uD83D\uDCB0 Price Range (per liter)"}),(0,s.jsxs)("div",{className:"price-range-inputs",children:[(0,s.jsx)("input",{type:"number",className:"price-input",placeholder:"Min",step:"0.01",min:"0",value:b.min,onChange:e=>f((0,m._)((0,h._)({},b),{min:e.target.value})),"aria-label":"Minimum price"}),(0,s.jsx)("span",{className:"price-separator",children:"to"}),(0,s.jsx)("input",{type:"number",className:"price-input",placeholder:"Max",step:"0.01",min:"0",value:b.max,onChange:e=>f((0,m._)((0,h._)({},b),{max:e.target.value})),"aria-label":"Maximum price"})]})]})]}),(0,s.jsxs)("div",{className:"filter-actions",children:[(0,s.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{c(""),u("all"),g("all"),f({min:"",max:""}),x("name"),N("all")},disabled:0===C,children:"Clear All Filters"}),(0,s.jsx)("button",{className:"btn btn-ghost btn-sm",onClick:()=>i(!1),children:"Close"})]})]}),C>0&&!n&&(0,s.jsxs)("div",{className:"active-filters-tags",children:[o&&(0,s.jsxs)("span",{className:"filter-tag",children:['Search: "',o,'"',(0,s.jsx)("button",{onClick:()=>c(""),"aria-label":"Remove search filter",children:"✕"})]}),"all"!==d&&(0,s.jsxs)("span",{className:"filter-tag",children:["Fuel: ",d,(0,s.jsx)("button",{onClick:()=>u("all"),"aria-label":"Remove fuel type filter",children:"✕"})]}),"all"!==p&&(0,s.jsxs)("span",{className:"filter-tag",children:["Brand: ",p,(0,s.jsx)("button",{onClick:()=>g("all"),"aria-label":"Remove brand filter",children:"✕"})]}),"all"!==y&&(0,s.jsxs)("span",{className:"filter-tag",children:["Region: ",y,(0,s.jsx)("button",{onClick:()=>N("all"),"aria-label":"Remove region filter",children:"✕"})]}),(b.min||b.max)&&(0,s.jsxs)("span",{className:"filter-tag",children:["Price: $",b.min||"0"," - $",b.max||"∞",(0,s.jsx)("button",{onClick:()=>f({min:"",max:""}),"aria-label":"Remove price filter",children:"✕"})]})]})]})};var g=t(5364);let b=e=>{let{stations:a=[],onStationClick:t,selectedStation:l,height:n=500}=e,[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),u=g.env.REACT_APP_MAPBOX_TOKEN;(0,r.useEffect)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{o({latitude:e.coords.latitude,longitude:e.coords.longitude})},e=>{console.warn("Geolocation error:",e)})},[]);let h=e=>{if(!e.fuelPrices||0===e.fuelPrices.length)return"#6B7280";let a=e.fuelPrices.reduce((e,a)=>e+parseFloat(a.price||0),0)/e.fuelPrices.length;return a<1.8?"#10B981":a<2?"#F59E0B":"#EF4444"},m=a.filter(e=>e.latitude&&e.longitude),p=m.length>0?{lat:m.reduce((e,a)=>e+a.latitude,0)/m.length,lng:m.reduce((e,a)=>e+a.longitude,0)/m.length}:{lat:-37.8136,lng:144.9631};return u?(0,s.jsxs)("div",{className:"station-map-container",style:{height:n},children:[(0,s.jsx)("div",{className:"map-static-view",children:(0,s.jsx)("img",{src:(()=>{let e=m.slice(0,50).map(e=>{let a=h(e).replace("#","");return"pin-s+".concat(a,"(").concat(e.longitude,",").concat(e.latitude,")")}).join(","),a=i?",pin-l-marker+3B82F6(".concat(i.longitude,",").concat(i.latitude,")"):"";return"".concat("https://api.mapbox.com/styles/v1/mapbox/streets-v11/static","/").concat(e).concat(a,"/").concat(p.lng,",").concat(p.lat,",").concat(11,"/").concat(800,"x").concat(500,"@2x?access_token=").concat(u)})(),alt:"Petrol stations map",className:"static-map-image",onLoad:()=>d(!0),onError:e=>{console.error("Map loading error"),e.target.style.display="none"}})}),(0,s.jsxs)("div",{className:"map-station-list",children:[(0,s.jsx)("h3",{children:"\uD83D\uDCCD Nearby Stations"}),(0,s.jsx)("div",{className:"station-list-items",children:m.slice(0,10).map((e,a)=>(0,s.jsxs)("div",{className:"station-list-item ".concat((null==l?void 0:l.id)===e.id?"selected":""),onClick:()=>{t&&t(e)},children:[(0,s.jsx)("div",{className:"station-color-indicator",style:{background:h(e)}}),(0,s.jsxs)("div",{className:"station-info",children:[(0,s.jsx)("strong",{children:e.name}),(0,s.jsx)("small",{children:e.address})]})]},e.id||a))})]}),(0,s.jsxs)("div",{className:"map-legend",children:[(0,s.jsxs)("div",{className:"legend-item",children:[(0,s.jsx)("span",{className:"legend-color",style:{background:"#10B981"}}),"Low Price"]}),(0,s.jsxs)("div",{className:"legend-item",children:[(0,s.jsx)("span",{className:"legend-color",style:{background:"#F59E0B"}}),"Medium Price"]}),(0,s.jsxs)("div",{className:"legend-item",children:[(0,s.jsx)("span",{className:"legend-color",style:{background:"#EF4444"}}),"High Price"]})]}),!c&&(0,s.jsxs)("div",{className:"map-loading",children:[(0,s.jsx)("div",{className:"loading-spinner"}),(0,s.jsx)("p",{children:"Loading map..."})]}),(0,s.jsxs)("div",{className:"map-info-banner",children:[(0,s.jsxs)("p",{children:["\uD83D\uDCCD Showing ",m.slice(0,50).length," stations on map"]}),m.length>50&&(0,s.jsx)("small",{children:"Limited to 50 stations for performance"})]})]}):(0,s.jsx)("div",{className:"station-map-container",style:{height:n},children:(0,s.jsxs)("div",{className:"map-error",children:[(0,s.jsx)("p",{children:"⚠️ Mapbox token not configured"}),(0,s.jsx)("p",{children:"Please add REACT_APP_MAPBOX_TOKEN to your .env.local file"})]})})};var f=t(5364);let v={baserow:{publicToken:f.env.REACT_APP_BASEROW_PUBLIC_TOKEN||"MIhg-ye0C_K99qvwTzoH6MCvTMAHLbwHR0C4aZKP674",token:f.env.REACT_APP_BASEROW_TOKEN||"G2bhijqxqtg0O05dc176fwDpaUPDSIgj",apiUrl:f.env.REACT_APP_BASEROW_API_URL||"https://api.baserow.io/api",databaseId:265358,mcpSseUrl:f.env.REACT_APP_BASEROW_SSE_URL||"https://api.baserow.io/mcp/ta1A1XNRrNHFLKV16tV3I0cSdkIzm9bE/sse"},api:{baseUrl:f.env.REACT_APP_API_URL||("localhost"===window.location.hostname?"http://localhost:3001":"/api")},tables:{petrolStations:{id:623329,name:"Petrol Stations"},fuelPrices:{id:623330,name:"Fuel Prices"},airtableImport:{id:623331,name:"Airtable import report"}},app:{name:f.env.REACT_APP_APP_NAME||"Petrol Prices Near Me",description:f.env.REACT_APP_APP_DESCRIPTION||"Melbourne Petrol Stations"}},x={async fetchWithRetry(e){let a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;for(let r=0;r<s;r++)try{let a=new AbortController,s=setTimeout(()=>a.abort(),15e3),l=await fetch(e,(0,m._)((0,h._)({},t),{signal:a.signal}));if(clearTimeout(s),429===l.status){let e=l.headers.get("Retry-After"),a=e?1e3*parseInt(e):1e3*Math.pow(2,r);await new Promise(e=>setTimeout(e,a));continue}if(l.status>=400&&l.status<500&&429!==l.status)throw Error("HTTP ".concat(l.status,": ").concat(l.statusText));if(l.ok)return l;throw Error("HTTP ".concat(l.status,": ").concat(l.statusText))}catch(t){if(a=t,r===s-1)throw a;let e=1e3*Math.pow(2,r);await new Promise(a=>setTimeout(a,e))}throw a},async fetchAllStations(){if(!v.api.baseUrl||"/api"===v.api.baseUrl)try{return await this.fetchAllStationsDirect(v.tables.petrolStations.id)}catch(e){throw e}try{let e=await this.fetchWithRetry("".concat(v.api.baseUrl,"/api/stations/all"),{method:"GET",headers:{"Content-Type":"application/json"}},3),a=await e.json();if(!a.success)throw Error(a.error||"Failed to fetch stations");return a.data}catch(e){if(e.message.includes("NetworkError")||e.message.includes("Failed to fetch")||"AbortError"===e.name)try{return await this.fetchAllStationsDirect(v.tables.petrolStations.id)}catch(e){throw e}throw e}},async createStation(e){try{let a=await fetch("".concat(v.api.baseUrl,"/api/stations"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let t=await a.json();if(!t.success)throw Error(t.error||"Failed to create station");return t.data}catch(e){throw e}},async updateStation(e,a){try{let t=await fetch("".concat(v.api.baseUrl,"/api/stations/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(1e4)});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let s=await t.json();if(!s.success)throw Error(s.error||"Failed to update station");return s.data}catch(e){throw e}},async deleteStation(e){try{let a=await fetch("".concat(v.api.baseUrl,"/api/stations/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let t=await a.json();if(!t.success)throw Error(t.error||"Failed to delete station");return!0}catch(e){throw e}},async getTableFields(e){try{let a=await fetch("".concat(v.api.baseUrl,"/api/baserow/fields/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let t=await a.json();if(!t.success)throw Error(t.error||"Failed to fetch table fields");return t.data}catch(e){throw e}},async fetchAllStationsDirect(e){let a=[],t=v.baserow.publicToken&&"your_public_token_here"!==v.baserow.publicToken,s=t?"".concat(v.baserow.apiUrl,"/database/rows/table/").concat(e,"/?user_field_names=true&size=100&public_token=").concat(v.baserow.publicToken):"".concat(v.baserow.apiUrl,"/database/rows/table/").concat(e,"/?user_field_names=true&size=100");try{for(;s;){let e={"Content-Type":"application/json",Accept:"application/json"};t||(e.Authorization="Token ".concat(v.baserow.token));let r=await this.fetchWithRetry(s,{method:"GET",headers:e,mode:"cors",credentials:"omit"},3),l=await r.json();if(!Array.isArray(l.results))throw Error("Unexpected API response structure");a.push(...l.results),s=l.next?t?"".concat(l.next,"&public_token=").concat(v.baserow.publicToken):l.next:null}return a}catch(e){throw e}},async testConnection(){try{let e=await fetch("".concat(v.api.baseUrl,"/api/baserow/test"));return await e.json()}catch(e){throw e}}};class y{async fetchStations(){if(this.cache&&this.cacheTimestamp&&Date.now()-this.cacheTimestamp<this.CACHE_DURATION)return console.log("\uD83D\uDCE6 Returning cached local data"),this.cache;try{console.log("\uD83D\uDDFA️ Loading stations from local GeoJSON...");let e=await this.loadGeoJSON();if(e&&e.length>0)return console.log("✅ Loaded ".concat(e.length," stations from GeoJSON")),this.cache=e,this.cacheTimestamp=Date.now(),e;console.log("\uD83D\uDCC4 Falling back to CSV data...");let a=await this.loadCSV();if(a&&a.length>0)return console.log("✅ Loaded ".concat(a.length," stations from CSV")),this.cache=a,this.cacheTimestamp=Date.now(),a;throw Error("No local data files available")}catch(e){throw console.error("❌ Error loading local data:",e),e}}async loadGeoJSON(){try{let e=await fetch("/data/stations.geojson");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json();if(!a.features||!Array.isArray(a.features))throw Error("Invalid GeoJSON format");return a.features.map((e,a)=>this.parseGeoJSONFeature(e,a))}catch(e){return console.warn("Could not load GeoJSON:",e.message),null}}parseGeoJSONFeature(e,a){var t;let s=e.properties||{},r=(null==(t=e.geometry)?void 0:t.coordinates)||[0,0],l=s.station_owner||"",n=l;l.includes("7-ELEVEN")||l.includes("7 ELEVEN")?n="7-Eleven":l.includes("BP")?n="BP":l.includes("SHELL")?n="Shell":l.includes("CALTEX")?n="Caltex":l.includes("AMPOL")?n="Ampol":l.includes("MOBIL")?n="Mobil":l.includes("UNITED")&&(n="United");let i=this.getRegionFromSuburb(s.station_suburb||"");return{id:s.objectid||a+1,name:s.station_name||"Unknown Station",address:s.station_address||s.gnaf_formatted_address||"",city:s.station_suburb||s.gnaf_suburb||"",postalCode:s.station_postcode||s.gnaf_postcode||"",region:i,state:s.station_state||"VIC",brand:n,category:s.feature_type||"PETROL STATION",Latitude:r[1],Longitude:r[0],lat:r[1],lng:r[0],operationalStatus:s.operational_status||"OPERATIONAL",description:s.station_description||"",lastUpdated:s.station_revised_date||new Date().toISOString(),spatialConfidence:s.spatial_confidence,industryId:s.industry_id,fuelPrices:this.generateMockPrices(n)}}generateMockPrices(e){let a={BP:{base:1.95,variance:.05},Shell:{base:1.93,variance:.05},Caltex:{base:1.94,variance:.05},Ampol:{base:1.92,variance:.05},"7-Eleven":{base:1.89,variance:.05},Mobil:{base:1.96,variance:.05},United:{base:1.88,variance:.05},default:{base:1.94,variance:.08}},t=a[e]||a.default,s=t.base+(Math.random()-.5)*t.variance*2;return{unleaded:s.toFixed(2),premium:(s+.15).toFixed(2),diesel:(s-.03).toFixed(2),e10:(s-.05).toFixed(2),lastUpdated:new Date().toISOString()}}getRegionFromSuburb(e){if(!e)return"VIC";let a=e.toUpperCase();return["PRESTON","COBURG","ESSENDON","TULLAMARINE","EPPING","THOMASTOWN","WOLLERT","CRAIGIEBURN","BROADMEADOWS","GREENSBOROUGH","ELTHAM"].some(e=>a.includes(e))?"North Melbourne":["FOOTSCRAY","SUNSHINE","WERRIBEE","POINT COOK","BROOKLYN","DEER PARK","HOPPERS CROSSING","ALTONA","WILLIAMSTOWN","MARIBYRNONG"].some(e=>a.includes(e))?"West Melbourne":["DONCASTER","BOX HILL","RINGWOOD","GLEN WAVERLEY","BURWOOD","MITCHAM","BLACKBURN","NUNAWADING","CROYDON","BAYSWATER"].some(e=>a.includes(e))?"East Melbourne":["MELBOURNE","CARLTON","FITZROY","SOUTH YARRA","RICHMOND","COLLINGWOOD","NORTHCOTE","BRUNSWICK","PARKVILLE","KENSINGTON","ABBOTSFORD"].some(e=>a.includes(e))?"Melbourne CBD":["FRANKSTON","DANDENONG","CRANBOURNE","CLAYTON","SPRINGVALE","NOBLE PARK","CHELTENHAM","MOORABBIN","MORDIALLOC","BENTLEIGH"].some(e=>a.includes(e))?"South East Melbourne":"VIC"}async loadCSV(){try{let e=await fetch("/data/stations.csv");if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.text();return this.parseCSV(a)}catch(e){return console.warn("Could not load CSV:",e.message),null}}parseCSV(e){let a=e.split("\n");if(a.length<2)return[];let t=a[0].split("|").map(e=>e.trim());return a.slice(1).filter(e=>e.trim()).map((e,a)=>{let s=e.split("|"),r={};return t.forEach((e,a)=>{r[e]=s[a]?s[a].trim():""}),{id:r.id||a+1,name:r["Station Name"]||"Unknown Station",address:r.Address||"",city:r.City||"",postalCode:r["Postal Code"]||"",region:r.Region||"VIC",category:r.Category||"PETROL STATION",brand:this.extractBrandFromCSV(r.brand),Latitude:0,Longitude:0,lat:0,lng:0,operationalStatus:"OPERATIONAL",locationDetails:r["Location Details"]||"",lastUpdated:new Date().toISOString(),fuelPrices:this.generateMockPrices(this.extractBrandFromCSV(r.brand))}})}extractBrandFromCSV(e){if(!e)return"Independent";let a=e.split("(")[0].trim();return a&&"Untitled.png"!==a?a:"Independent"}clearCache(){this.cache=null,this.cacheTimestamp=null}constructor(){this.cache=null,this.cacheTimestamp=null,this.CACHE_DURATION=18e5}}let N=new y;class S{getActiveSource(){return this.activeSource}setActiveSource(e){console.log("\uD83D\uDD04 Switching data source from ".concat(this.activeSource," to ").concat(e)),this.activeSource=e,this.clearCache()}clearCache(){console.log("\uD83D\uDDD1️ Clearing data cache"),this.dataCache.clear(),this.lastFetchTime=null}isCacheValid(){return!!this.lastFetchTime&&Date.now()-this.lastFetchTime<this.cacheTimeout}validateStationData(e,a){if(!e||"object"!=typeof e)return{valid:!1,reason:"Invalid station object"};let t=e.Latitude||e.latitude||e.lat||e.Y||e.field_5072136||e.field5072136||null,s=e.Longitude||e.longitude||e.lng||e.X||e.field_5072137||e.field5072137||null;return(null!==t&&"string"==typeof t&&(t=parseFloat(t)),null!==s&&"string"==typeof s&&(s=parseFloat(s)),null===t||null===s||isNaN(t)||isNaN(s))?(console.warn("⚠️ Station ".concat(a+1," has invalid coordinates:"),{lat:t,lng:s,stationId:e.id,stationName:e["Station Name"]||e.station_name||e.name,availableFields:Object.keys(e).filter(e=>e.toLowerCase().includes("lat")||e.toLowerCase().includes("long")||e.toLowerCase().includes("x")||e.toLowerCase().includes("y"))}),{valid:!1,reason:"Invalid coordinates"}):t<-45||t>-10||s<110||s>155?(console.warn("⚠️ Station ".concat(a+1," outside Australia:"),{lat:t,lng:s,name:e["Station Name"]||e.station_name||e.name}),{valid:!1,reason:"Coordinates outside Australia"}):{valid:!0,lat:t,lng:s}}transformStationData(e,a){let t=this.validateStationData(e,a);if(!t.valid)return null;let s=function(e,a){let t=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=[];if(!e||"object"!=typeof e)return{valid:!1,errors:["Station at index ".concat(a," is not an object")],data:null};let s=e.id||e.Id;s||t.push("Station at index ".concat(a," missing id"));let r=e["Station Name"]||e.station_name||e.field_5072130||e.name;r&&"string"==typeof r||t.push("Station at index ".concat(a," missing or invalid name"));let l=parseFloat(e.Latitude||e.Y||e.lat||e.latitude||e.field_5072136),n=parseFloat(e.Longitude||e.X||e.lng||e.longitude||e.field_5072137);!l||!n||isNaN(l)||isNaN(n)?t.push("Station at index ".concat(a," has invalid coordinates: lat=").concat(l,", lng=").concat(n)):((l<-90||l>90)&&t.push("Station at index ".concat(a," has invalid latitude: ").concat(l," (must be between -90 and 90)")),(n<-180||n>180)&&t.push("Station at index ".concat(a," has invalid longitude: ").concat(n," (must be between -180 and 180)")));let i=e["Fuel Prices"]||e.field_5072139||e.fuelPrices;return 0===(i=Array.isArray(i)?i.filter(e=>e&&"object"==typeof e&&e.type):[]).length&&(i=[]),{valid:0===t.length,errors:t,data:0===t.length?{id:s,name:r,lat:l,lng:n,address:e.Address||e.station_address||e.field_5072131||e.address,city:e.City||e.station_suburb||e.field_5072132||e.city,region:e.Region||e.station_state||e.field_5072134||e.region,postalCode:e["Postal Code"]||e.station_postcode||e.field_5072133||e.postalCode,country:e.Country||e.field_5072135||e.country||"AUSTRALIA",category:e.Category||e.feature_type||e.field_5072138||e.category,locationDetails:e["Location Details"]||e.station_description||e.field_5072140||e.locationDetails,fuelPrices:i,brand:e.brand||e.station_owner||e.Brand}:null}}(e,a);return t.valid?{valid:!0,station:{id:t.data.id,name:t.data.name,lat:t.data.lat,lng:t.data.lng,address:t.data.address||"".concat(t.data.city||"Melbourne",", VIC"),city:t.data.city||"Melbourne",region:t.data.region,postalCode:t.data.postalCode,country:t.data.country,category:t.data.category,locationDetails:t.data.locationDetails,fuelPrices:t.data.fuelPrices,brand:t.data.brand||"Unknown",prices:{unleaded:180+20*Math.random(),premium:190+20*Math.random(),premium98:200+25*Math.random(),diesel:175+20*Math.random(),gas:85+15*Math.random()},source:"baserow",lastUpdated:new Date().toISOString()},errors:[]}:(console.warn("⚠️ Invalid station at index ".concat(a,":"),t.errors),{valid:!1,station:null,errors:t.errors})}(e,a);return s.valid?(0,m._)((0,h._)({},s.station),{latitude:t.lat,longitude:t.lng,lat:t.lat,lng:t.lng,source:this.activeSource,fuelPrices:Array.isArray(s.station.fuelPrices)?s.station.fuelPrices.filter(e=>e&&"object"==typeof e):[]}):(console.warn("⚠️ Skipping invalid station at index ".concat(a,":"),s.errors),null)}async fetchStations(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a="stations_".concat(this.activeSource);if(!e&&this.isCacheValid()&&this.dataCache.has(a))return console.log("\uD83D\uDCE6 Returning cached station data"),this.dataCache.get(a);if(this.isLoading)return console.log("⏳ Data fetch already in progress, waiting..."),new Promise((e,t)=>{let s=Date.now(),r=()=>{let l=Date.now()-s;this.isLoading?l>=15e3?(console.error("⏰ Wait timeout after ".concat(l,"ms - isLoading flag stuck!")),this.isLoading=!1,t(Error("Data fetch wait timeout - concurrent request took too long"))):setTimeout(r,100):(console.log("✅ Wait completed after ".concat(l,"ms")),e(this.dataCache.get(a)||[]))};r()});try{this.isLoading=!0,console.log("\uD83D\uDE80 Fetching stations from ".concat(this.activeSource,"..."));let e=[];switch(this.activeSource){case"local":try{e=await N.fetchStations()}catch(a){console.warn("⚠️ Local data failed, trying Baserow...",a.message),this.setActiveSource("baserow");try{e=await x.fetchAllStations()}catch(a){console.warn("⚠️ Baserow also failed, using mock data",a.message),this.setActiveSource("mock"),e=this.getMockStations()}}break;case"baserow":try{e=await x.fetchAllStations()}catch(a){console.warn("⚠️ Baserow API failed, falling back to mock data:",a.message),console.log("\uD83D\uDD04 Switching to mock data source due to API issues"),this.setActiveSource("mock"),e=this.getMockStations()}break;case"airtable":throw Error("Airtable integration not implemented");case"mock":e=this.getMockStations();break;default:throw Error("Unknown data source: ".concat(this.activeSource))}if(console.log("\uD83D\uDCCA Raw data received: ".concat(e.length," stations from ").concat(this.activeSource)),!Array.isArray(e)||0===e.length)throw Error("No station data received from ".concat(this.activeSource));let t=e.map((e,a)=>this.transformStationData(e,a)).filter(e=>null!==e);if(console.log("\uD83D\uDCC8 Data transformation complete:"),console.log("   - Raw stations: ".concat(e.length)),console.log("   - Valid stations: ".concat(t.length)),console.log("   - Invalid stations: ".concat(e.length-t.length)),0===t.length)throw Error("No valid stations found after data transformation");return t.length<10&&console.warn("⚠️ Only ".concat(t.length," valid stations found - this may indicate data quality issues")),this.dataCache.set(a,t),this.lastFetchTime=Date.now(),console.log("✅ Successfully loaded ".concat(t.length," stations from ").concat(this.activeSource)),t}catch(t){console.error("❌ Error fetching stations from ".concat(this.activeSource,":"),t);let e=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"processing request",t="string"==typeof e?e:e.message||"Unknown error";return t.includes("NetworkError")||t.includes("Failed to fetch")?"Unable to connect to the server. Please check your internet connection and try again.":t.includes("timeout")||t.includes("AbortError")?"The request is taking longer than expected. Please check your connection and try again.":t.includes("CORS")?"There's a connection issue with our servers. Please try again in a few moments.":t.includes("401")||t.includes("Unauthorized")?"Authentication failed. Please refresh the page and try again.":t.includes("404")||t.includes("Not Found")?"The requested information could not be found. Please try again later.":t.includes("429")||t.includes("Too Many Requests")?"Too many requests. Please wait a moment and try again.":t.includes("500")||t.includes("502")||t.includes("503")?"Our servers are experiencing issues. Please try again in a few moments.":t.includes("invalid")||t.includes("validation")?"The data format is incorrect. Please refresh the page and try again.":"An error occurred while ".concat(a,". Please try again. If the problem persists, contact support.")}(t,"loading station data");if(console.log("\uD83D\uDCAC User-friendly message: ".concat(e)),this.lastError={technical:t.message,userFriendly:e,timestamp:new Date().toISOString()},this.dataCache.has(a))return console.log("\uD83D\uDD04 Returning cached data due to error"),this.dataCache.get(a);return console.log("\uD83D\uDD04 Returning mock data as fallback"),this.getMockStations()}finally{this.isLoading=!1}}getMockStations(){return[{id:1,name:"Shell Melbourne CBD",lat:-37.8136,lng:144.9631,prices:{unleaded:185.9,premium:195.9,premium98:210.5,diesel:179.9,gas:95.2},address:"123 Collins Street, Melbourne",city:"Melbourne",source:"mock",lastUpdated:new Date().toISOString()},{id:2,name:"BP South Yarra",lat:-37.8387,lng:144.9924,prices:{unleaded:182.5,premium:192.5,premium98:207.8,diesel:176.8,gas:92.1},address:"456 Toorak Road, South Yarra",city:"South Yarra",source:"mock",lastUpdated:new Date().toISOString()},{id:3,name:"Caltex Richmond",lat:-37.8197,lng:145.0058,prices:{unleaded:188.9,premium:198.9,premium98:213.2,diesel:183.2,gas:97.5},address:"789 Swan Street, Richmond",city:"Richmond",source:"mock",lastUpdated:new Date().toISOString()}]}getLastError(){return this.lastError||null}clearError(){this.lastError=null}getStatus(){return{activeSource:this.activeSource,isLoading:this.isLoading,lastFetchTime:this.lastFetchTime,cacheValid:this.isCacheValid(),cacheSize:this.dataCache.size,availableSources:["local","baserow","airtable","mock"],lastError:this.lastError}}async testConnection(){try{switch(this.activeSource){case"local":try{return{connected:(await fetch("/data/stations.geojson",{method:"HEAD"})).ok,source:"local (GeoJSON)"}}catch(e){return{connected:!1,error:"Local data files not accessible"}}case"baserow":return await x.testConnection();case"airtable":throw Error("Airtable integration not implemented");case"mock":return{connected:!0,source:"mock"};default:throw Error("Unknown data source: ".concat(this.activeSource))}}catch(e){return console.error("❌ Connection test failed for ".concat(this.activeSource,":"),e),{connected:!1,error:e.message}}}constructor(){this.activeSource="local",this.dataCache=new Map,this.isLoading=!1,this.lastFetchTime=null,this.cacheTimeout=3e5}}let j=new S;var C=t(5875);let w=e=>{let{onClose:a}=e,[t,l]=(0,r.useState)({}),[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(""),[p,g]=(0,r.useState)(""),[b,f]=(0,r.useState)(!1),v=["Shell","BP","7-Eleven","Mobil","Coles Express","Caltex","Ampol","United","Liberty","Metro","Puma","Vibe","Independent"];(0,r.useEffect)(()=>{let e=localStorage.getItem("brandLogos");if(e)try{l(JSON.parse(e))}catch(e){console.error("Error loading brand logos:",e)}},[]);let x=e=>{localStorage.setItem("brandLogos",JSON.stringify(e)),l(e)},y=[...new Set([...v,...Object.keys(t)])].sort();return(0,s.jsx)("div",{className:"brand-logo-manager-overlay",children:(0,s.jsxs)("div",{className:"brand-logo-manager",children:[(0,s.jsxs)("div",{className:"manager-header",children:[(0,s.jsx)("h2",{children:"\uD83C\uDFA8 Brand Logo Manager"}),(0,s.jsx)("button",{onClick:a,className:"close-btn","aria-label":"Close",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"manager-content",children:[(0,s.jsxs)("div",{className:"upload-section",children:[(0,s.jsx)("h3",{children:"Upload Brand Logo"}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"brand-select",children:"Select Brand"}),(0,s.jsxs)("div",{className:"brand-select-group",children:[(0,s.jsxs)("select",{id:"brand-select",value:n,onChange:e=>i(e.target.value),className:"brand-select",children:[(0,s.jsx)("option",{value:"",children:"Choose a brand..."}),y.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsx)("button",{onClick:()=>f(!0),className:"add-brand-btn",title:"Add new brand",children:"+"})]})]}),b&&(0,s.jsxs)("div",{className:"add-brand-form",children:[(0,s.jsx)("input",{type:"text",placeholder:"Enter new brand name",value:p,onChange:e=>g(e.target.value),className:"brand-input"}),(0,s.jsxs)("div",{className:"add-brand-actions",children:[(0,s.jsx)("button",{onClick:()=>p.trim()?v.includes(p)||t[p]?void alert("This brand already exists"):void(i(p),f(!1),g("")):void alert("Please enter a brand name"),className:"btn-primary",children:"Add"}),(0,s.jsx)("button",{onClick:()=>{f(!1),g("")},className:"btn-secondary",children:"Cancel"})]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"logo-upload",children:"Upload Logo Image"}),(0,s.jsx)("input",{id:"logo-upload",type:"file",accept:"image/*",onChange:e=>{let a=e.target.files[0];if(a){if(!a.type.startsWith("image/"))return void alert("Please select an image file (PNG, JPG, SVG)");if(a.size>2097152)return void alert("File size must be less than 2MB");c(a);let e=new FileReader;e.onload=e=>{u(e.target.result)},e.readAsDataURL(a)}},className:"file-input"}),(0,s.jsx)("p",{className:"help-text",children:"Recommended: PNG or SVG, transparent background, max 2MB"})]}),d&&(0,s.jsxs)("div",{className:"preview-section",children:[(0,s.jsx)("h4",{children:"Preview"}),(0,s.jsx)("div",{className:"preview-box",children:(0,s.jsx)("img",{src:d,alt:"Logo preview",className:"preview-image"})})]}),(0,s.jsx)("button",{onClick:()=>n?d?void(x((0,m._)((0,h._)({},t),{[n]:d})),c(null),u(""),i(""),alert("Logo uploaded successfully for ".concat(n,"!"))):void alert("Please select an image file"):void alert("Please select a brand"),className:"upload-btn",disabled:!n||!d,children:"Upload Logo"})]}),(0,s.jsxs)("div",{className:"existing-logos-section",children:[(0,s.jsxs)("div",{className:"section-header",children:[(0,s.jsxs)("h3",{children:["Uploaded Logos (",Object.keys(t).length,")"]}),Object.keys(t).length>0&&(0,s.jsx)("button",{onClick:()=>{let e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download="brand-logos-backup.json",s.click(),URL.revokeObjectURL(a)},className:"export-btn",children:"\uD83D\uDCBE Export Backup"})]}),0===Object.keys(t).length?(0,s.jsxs)("div",{className:"empty-state",children:[(0,s.jsx)("p",{children:"No logos uploaded yet"}),(0,s.jsx)("p",{className:"help-text",children:"Upload your first brand logo above"})]}):(0,s.jsx)("div",{className:"logos-grid",children:Object.entries(t).map(e=>{let[a,r]=e;return(0,s.jsxs)("div",{className:"logo-card",children:[(0,s.jsx)("div",{className:"logo-card-image",children:(0,s.jsx)("img",{src:r,alt:"".concat(a," logo")})}),(0,s.jsxs)("div",{className:"logo-card-info",children:[(0,s.jsx)("h4",{children:a}),(0,s.jsx)("button",{onClick:()=>(e=>{if(window.confirm("Delete logo for ".concat(e,"?"))){let a=(0,h._)({},t);delete a[e],x(a)}})(a),className:"delete-btn","aria-label":"Delete ".concat(a," logo"),children:"\uD83D\uDDD1️"})]})]},a)})})]})]}),(0,s.jsx)("div",{className:"manager-footer",children:(0,s.jsx)("p",{className:"info-text",children:"ℹ️ Logos are stored in your browser's local storage. Export regularly for backup."})})]})})},A=()=>{let[e,a]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[n,i]=(0,r.useState)(""),[o,c]=(0,r.useState)("all"),[d,u]=(0,r.useState)("all"),[h,m]=(0,r.useState)("all"),[p,g]=(0,r.useState)("all"),[b,f]=(0,r.useState)(1),[v,x]=(0,r.useState)(!1),[y,N]=(0,r.useState)({});(0,r.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("brandLogos");if(e)try{N(JSON.parse(e))}catch(e){console.error("Error loading brand logos:",e)}};e();let a=a=>{"brandLogos"===a.key&&e()};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)},[]);let S=(0,r.useCallback)(e=>{let a=e.split("\n"),t=a[0].split(",").map(e=>e.trim().replace(/"/g,""));return a.slice(1).filter(e=>e.trim()).map((e,a)=>{let s=e.split(",").map(e=>e.trim().replace(/"/g,"")),r={};t.forEach((e,a)=>{r[e]=s[a]||""});let l=[];return Object.keys(r).forEach(e=>{if(e.toLowerCase().includes("price")&&r[e]){let a=e.toLowerCase().includes("unleaded")?"Unleaded":e.toLowerCase().includes("premium")?"Premium":e.toLowerCase().includes("diesel")?"Diesel":e.toLowerCase().includes("lpg")?"LPG":"Fuel",t=parseFloat(r[e]);!isNaN(t)&&t>0&&l.push({type:a,price:t})}}),{id:a+1,name:r["Station Name"]||r.name||"",address:r.Address||r.address||"",city:r.City||r.city||"",postalCode:r["Postal Code"]||r.postalCode||"",region:r.Region||r.region||"",brand:r.brand||r.Brand||"",latitude:parseFloat(r.Latitude||r.lat||0),longitude:parseFloat(r.Longitude||r.lng||0),category:r.Category||r.category||"",locationDetails:r["Location Details"]||r.locationDetails||"",lastUpdated:r["Last Updated"]||new Date().toISOString(),fuelPrices:l.length>0?l:[{type:"Unleaded",price:0},{type:"Premium",price:0},{type:"Diesel",price:0}]}}).filter(e=>e.name)},[]),A=(0,r.useCallback)(async()=>{try{let e=await fetch("/export-Petrol-Stations-Grid-view.csv");if(!e.ok)return null;let a=await e.text();return S(a)}catch(e){return console.log("CSV not available, using Baserow API"),null}},[S]);(0,r.useEffect)(()=>{(async()=>{try{l(!0);let e=await A();if(e&&e.length>0)return void a(e);let t=await j.fetchStations();a(t)}catch(e){console.error("Error loading stations:",e)}finally{l(!1)}})()},[A]);let E=(0,r.useMemo)(()=>["all",...[...new Set(e.map(e=>e.brand).filter(Boolean))].sort()],[e]),P=(0,r.useMemo)(()=>["all",...[...new Set(e.map(e=>e.region).filter(Boolean))].sort()],[e]),D=(0,r.useMemo)(()=>["all",...[...new Set(e.map(e=>e.city).filter(Boolean))].sort()],[e]),T=(0,r.useMemo)(()=>["all",...[...new Set(e.flatMap(e=>Array.isArray(e.fuelPrices)?e.fuelPrices.filter(e=>e&&"object"==typeof e&&e.type).map(e=>e.type):[]).filter(Boolean))].sort()],[e]),L=(0,r.useMemo)(()=>{let a=[...e];if(n){let e=n.toLowerCase();a=a.filter(a=>{var t,s,r,l,n;return(null==(t=a.name)?void 0:t.toLowerCase().includes(e))||(null==(s=a.address)?void 0:s.toLowerCase().includes(e))||(null==(r=a.city)?void 0:r.toLowerCase().includes(e))||(null==(l=a.brand)?void 0:l.toLowerCase().includes(e))||(null==(n=a.postalCode)?void 0:n.includes(e))}),(0,C.Ar)(n,a.length)}return"all"!==o&&(a=a.filter(e=>e.brand===o),(0,C.qh)("brand",o)),"all"!==d&&(a=a.filter(e=>e.region===d),(0,C.qh)("region",d)),"all"!==h&&(a=a.filter(e=>e.city===h),(0,C.qh)("suburb",h)),"all"!==p&&(a=a.filter(e=>Array.isArray(e.fuelPrices)&&e.fuelPrices.some(e=>e&&e.type===p)),(0,C.qh)("fuelType",p)),a},[e,n,o,d,h,p]),k=Math.ceil(L.length/12),M=L.slice((b-1)*12,12*b),R=e=>e&&0!==e?"$".concat(e.toFixed(2)):"N/A";return t?(0,s.jsxs)("div",{className:"station-cards-loading",children:[(0,s.jsx)("div",{className:"loading-spinner"}),(0,s.jsx)("p",{children:"Loading stations..."})]}):(0,s.jsxs)("div",{className:"station-cards-container",children:[(0,s.jsxs)("div",{className:"cards-header",children:[(0,s.jsx)("h2",{children:"Melbourne Petrol Stations"}),(0,s.jsxs)("p",{className:"cards-subtitle",children:["Find the best fuel prices near you • ",L.length," stations available"]}),(0,s.jsx)("button",{onClick:()=>x(!0),className:"admin-btn",title:"Manage Brand Logos",children:"\uD83C\uDFA8 Manage Logos"})]}),v&&(0,s.jsx)(w,{onClose:()=>{x(!1);let e=localStorage.getItem("brandLogos");if(e)try{N(JSON.parse(e))}catch(e){console.error("Error reloading brand logos:",e)}}}),(0,s.jsxs)("div",{className:"cards-filters",children:[(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"search",children:"\uD83D\uDD0D Search Stations"}),(0,s.jsx)("input",{id:"search",name:"search",type:"search",placeholder:"Search by name, address, suburb...",value:n,onChange:e=>i(e.target.value),className:"search-input"})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"brand-filter",children:"\uD83C\uDFEA Brand"}),(0,s.jsx)("select",{id:"brand-filter",name:"brand-filter",value:o,onChange:e=>c(e.target.value),className:"filter-select",children:E.map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Brands":e},e))})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"suburb-filter",children:"\uD83C\uDFD8️ Suburb"}),(0,s.jsx)("select",{id:"suburb-filter",name:"suburb-filter",value:h,onChange:e=>m(e.target.value),className:"filter-select",children:D.map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Suburbs":e},e))})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"fuel-filter",children:"⛽ Fuel Type"}),(0,s.jsx)("select",{id:"fuel-filter",name:"fuel-filter",value:p,onChange:e=>g(e.target.value),className:"filter-select",children:T.map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Fuel Types":e},e))})]}),(0,s.jsxs)("div",{className:"filter-group",children:[(0,s.jsx)("label",{htmlFor:"region-filter",children:"\uD83D\uDCCD Region"}),(0,s.jsx)("select",{id:"region-filter",name:"region-filter",value:d,onChange:e=>u(e.target.value),className:"filter-select",children:P.map(e=>(0,s.jsx)("option",{value:e,children:"all"===e?"All Regions":e},e))})]})]}),M.length>0?(0,s.jsx)("div",{className:"cards-grid",children:M.map(e=>{let a=Array.isArray(e.fuelPrices)?e.fuelPrices.find(e=>e&&e.type&&e.type.toLowerCase().includes("unleaded")):null,t=Array.isArray(e.fuelPrices)?e.fuelPrices.find(e=>e&&e.type&&e.type.toLowerCase().includes("diesel")):null;return(0,s.jsxs)("div",{className:"station-card",children:[(0,s.jsxs)("div",{className:"card-header",children:[(0,s.jsx)("img",{src:(e=>e&&y[e]?y[e]:"/images/brands/default-logo.svg")(e.brand),alt:"".concat(e.brand||"Station"," logo"),className:"brand-logo",onError:e=>{e.target.src="/images/brands/default-logo.svg"}}),(0,s.jsx)("div",{className:"brand-badge",children:e.brand||"Independent"})]}),(0,s.jsxs)("div",{className:"card-content",children:[(0,s.jsx)("h3",{className:"station-name",children:e.name}),(0,s.jsxs)("p",{className:"station-address",children:[e.address&&"".concat(e.address,", "),e.city&&"".concat(e.city," "),e.postalCode&&e.postalCode]}),(0,s.jsxs)("div",{className:"fuel-prices",children:[(0,s.jsxs)("div",{className:"fuel-price-item ".concat(a?"unleaded":""),children:[(0,s.jsxs)("div",{className:"fuel-type",children:[(0,s.jsx)("div",{className:"fuel-icon unleaded",children:"U"}),"Unleaded"]}),(0,s.jsx)("div",{className:"price",children:a&&a.price?R(a.price):"N/A"})]}),(0,s.jsxs)("div",{className:"fuel-price-item ".concat(t?"diesel":""),children:[(0,s.jsxs)("div",{className:"fuel-type",children:[(0,s.jsx)("div",{className:"fuel-icon diesel",children:"D"}),"Diesel"]}),(0,s.jsx)("div",{className:"price",children:t&&t.price?R(t.price):"N/A"})]})]}),(0,s.jsxs)("div",{className:"card-actions",children:[e.latitude&&e.longitude?(0,s.jsx)("a",{href:"https://www.google.com/maps/dir/?api=1&destination=".concat(e.latitude,",").concat(e.longitude),target:"_blank",rel:"noopener noreferrer",className:"action-btn",children:"\uD83E\uDDED Directions"}):(0,s.jsx)("button",{className:"action-btn",disabled:!0,children:"\uD83D\uDCCD No Location"}),(0,s.jsx)("button",{className:"action-btn secondary",children:"ℹ️ More Info"})]})]})]},e.id)})}):(0,s.jsxs)("div",{className:"no-results",children:[(0,s.jsx)("h3",{children:"No stations found"}),(0,s.jsx)("p",{children:"Try adjusting your search criteria or filters"})]}),k>1&&(0,s.jsxs)("div",{className:"cards-pagination",children:[(0,s.jsx)("button",{onClick:()=>f(e=>Math.max(1,e-1)),disabled:1===b,className:"page-btn",children:"← Previous"}),(0,s.jsxs)("span",{className:"page-info",children:["Page ",b," of ",k]}),(0,s.jsx)("button",{onClick:()=>f(e=>Math.min(k,e+1)),disabled:b===k,className:"page-btn",children:"Next →"})]}),(0,s.jsx)("div",{className:"cards-footer",children:(0,s.jsxs)("p",{children:["Showing ",(b-1)*12+1,"-",Math.min(12*b,L.length)," of ",L.length," stations",(n||"all"!==o||"all"!==d||"all"!==h||"all"!==p)&&" (filtered from ".concat(e.length," total)")]})})]})};var E=t(9468),P=!0;function D(e){let a,{allStations:t,selectedRegionData:n}=e,{region:o}=(0,l.useRouter)().query,[h]=(0,r.useState)(t),[m,g]=(0,r.useState)(t),[f,v]=(0,r.useState)(1),[x,y]=(0,r.useState)({}),[N,S]=(0,r.useState)("cards"),[j,w]=(0,r.useState)(null),P=o?u.WR[o.toUpperCase()]:null;(0,r.useEffect)(()=>{console.log("\uD83D\uDDFA️ DirectoryPage mounted (Next.js)"),console.log("\uD83D\uDCCB Region param from URL:",o),console.log("\uD83C\uDFAF Selected region:",(null==P?void 0:P.name)||"All Stations"),console.log("\uD83D\uDCCA Pre-loaded stations:",h.length)},[o,P,h.length]),(0,r.useEffect)(()=>{(0,C.oe)(P?"Directory - ".concat(P.name):"Directory - All Stations")},[P]);let D=(0,r.useCallback)(e=>{let a=[...h];if(P&&(a=a.filter(e=>(0,u.t_)(e.latitude,e.longitude,e.city).id===P.id)),e.search){let t=e.search.toLowerCase();a=a.filter(e=>e.name.toLowerCase().includes(t)||e.city.toLowerCase().includes(t)||e.address.toLowerCase().includes(t)),(0,C.Ar)(e.search,a.length)}e.fuelType&&"all"!==e.fuelType&&(a=a.filter(a=>{var t;return null==(t=a.fuelPrices)?void 0:t.some(a=>a.fuelType.toLowerCase()===e.fuelType.toLowerCase())}),(0,C.qh)("fuel_type",e.fuelType)),e.brand&&"all"!==e.brand&&(a=a.filter(a=>a.brand.toLowerCase().includes(e.brand.toLowerCase())),(0,C.qh)("brand",e.brand)),e.sortBy&&a.sort((a,t)=>{switch(e.sortBy){case"name":return a.name.localeCompare(t.name);case"price-low":var s,r,l,n;return((null==(s=a.fuelPrices)?void 0:s.reduce((e,a)=>e+a.price,0))/((null==(r=a.fuelPrices)?void 0:r.length)||1)||1/0)-((null==(l=t.fuelPrices)?void 0:l.reduce((e,a)=>e+a.price,0))/((null==(n=t.fuelPrices)?void 0:n.length)||1)||1/0);default:return 0}}),g(a),v(1)},[h,P]),T=(0,r.useCallback)(e=>{y(e),D(e)},[D]);(0,r.useEffect)(()=>{D(x)},[D,x]);let L=Math.ceil(m.length/12),k=(f-1)*12,M=m.slice(k,k+12),R=e=>{v(e),window.scrollTo({top:0,behavior:"smooth"})},O=P?"".concat(P.name," Petrol Stations - Live Fuel Prices"):"Melbourne Petrol Stations Directory - Live Fuel Prices",_=P?"Find the cheapest petrol prices in ".concat(P.name,", Melbourne. Compare real-time fuel prices from ").concat(m.length,"+ stations."):"Browse ".concat(m.length,"+ petrol stations across Melbourne. Compare live fuel prices and find the cheapest petrol near you.");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{children:[(0,s.jsx)("title",{children:O}),(0,s.jsx)("meta",{name:"description",content:_}),(0,s.jsx)("meta",{name:"keywords",content:"petrol prices ".concat((null==P?void 0:P.name)||"melbourne",", fuel prices ").concat((null==P?void 0:P.name)||"melbourne",", cheapest petrol, station directory")}),(0,s.jsx)("link",{rel:"canonical",href:"/directory".concat(o?"?region=".concat(o):"")}),(0,s.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify({"@context":"https://schema.org","@type":"ItemList",name:"Melbourne Petrol Station Prices",description:"Real-time fuel prices from petrol stations across Melbourne",numberOfItems:(a=m.slice(0,10)).length,itemListElement:a.slice(0,10).map((e,a)=>({"@type":"ListItem",position:a+1,item:{"@context":"https://schema.org","@type":"GasStation",name:e.name,address:{"@type":"PostalAddress",streetAddress:e.address,addressLocality:e.city,addressRegion:"VIC",postalCode:e.postalCode,addressCountry:"AU"},geo:{"@type":"GeoCoordinates",latitude:e.latitude,longitude:e.longitude},telephone:e.phone,openingHoursSpecification:e.hours?{"@type":"OpeningHoursSpecification",dayOfWeek:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],opens:"00:00",closes:"23:59"}:void 0,priceRange:e.fuelPrices?"$".concat(Math.min(...e.fuelPrices.map(e=>parseFloat(e.price||0)))," - $").concat(Math.max(...e.fuelPrices.map(e=>parseFloat(e.price||0)))):void 0}}))})}})]}),(0,s.jsxs)("div",{className:"directory-page",children:[(0,s.jsx)(E.A,{customCrumbs:P?[{label:"Home",path:"/",icon:"\uD83C\uDFE0"},{label:"Station Directory",path:"/directory"},{label:P.name,path:"/directory?region=".concat(o),isActive:!0}]:void 0}),(0,s.jsx)("div",{className:"directory-header",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsx)(d.Uu,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:(0,s.jsxs)("div",{className:"header-content",children:[(0,s.jsx)(c(),{href:"/",className:"back-link","aria-label":"Back to regions",children:"← Back to Regions"}),(0,s.jsx)("h1",{children:P?P.name:"All Melbourne Petrol Stations"}),P&&(0,s.jsx)("p",{className:"region-description",children:P.description}),(0,s.jsx)("div",{className:"header-stats",children:(0,s.jsxs)("div",{className:"stat",children:[(0,s.jsx)("span",{className:"stat-number",children:m.length}),(0,s.jsx)("span",{className:"stat-label",children:"Stations Found"})]})})]})})})}),(0,s.jsx)(p,{onFilterChange:T,stationsCount:m.length,totalStations:h.length}),(0,s.jsx)("div",{className:"view-controls",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"view-toggle",children:[(0,s.jsx)("button",{className:"view-btn ".concat("cards"===N?"active":""),onClick:()=>S("cards"),children:"\uD83D\uDCCB Cards"}),(0,s.jsx)("button",{className:"view-btn ".concat("map"===N?"active":""),onClick:()=>S("map"),children:"\uD83D\uDDFA️ Map"})]})})}),"map"===N?(0,s.jsx)(b,{stations:m,onStationClick:e=>w(e)}):(0,s.jsx)(A,{stations:M,onStationClick:e=>w(e)}),"map"!==N&&L>1&&(0,s.jsxs)("div",{className:"pagination",children:[(0,s.jsx)("button",{onClick:()=>R(f-1),disabled:1===f,children:"Previous"}),(0,s.jsxs)("span",{children:["Page ",f," of ",L]}),(0,s.jsx)("button",{onClick:()=>R(f+1),disabled:f===L,children:"Next"})]})]})]})}},3422:(e,a,t)=>{"use strict";t.d(a,{WR:()=>s,t_:()=>r});let s={NORTHERN:{id:"northern",name:"Northern Suburbs",color:"#7B68B6",icon:"\uD83C\uDF06",description:"Preston, Coburg, Essendon, Tullamarine, Sunbury",suburbs:["Preston","Coburg","Brunswick","Essendon","Airport West","Tullamarine","Sunbury","Keilor","Niddrie","Strathmore","Moonee Ponds","Ascot Vale","Flemington","Kensington","Glenroy","Oak Park","Pascoe Vale","Brunswick West","Reservoir","Thornbury","Northcote","Fairfield","Ivanhoe"],bounds:{latMin:-37.75,latMax:-37.6,lngMin:144.85,lngMax:145.05}},WESTERN:{id:"western",name:"Western Suburbs",color:"#FF6B6B",icon:"\uD83C\uDF05",description:"Footscray, Sunshine, Werribee, Point Cook",suburbs:["Footscray","Sunshine","Werribee","Point Cook","Altona","Williamstown","Newport","Yarraville","Seddon","Hoppers Crossing","Tarneit","Truganina","Caroline Springs","Deer Park","St Albans","Melton","Laverton"],bounds:{latMin:-37.95,latMax:-37.7,lngMin:144.7,lngMax:144.85}},EASTERN:{id:"eastern",name:"Eastern Suburbs",color:"#4ECDC4",icon:"\uD83C\uDFDE️",description:"Doncaster, Box Hill, Ringwood, Glen Waverley",suburbs:["Doncaster","Box Hill","Ringwood","Templestowe","Bulleen","Balwyn","Kew","Camberwell","Hawthorn","Surrey Hills","Blackburn","Mitcham","Nunawading","Vermont","Forest Hill","Croydon","Lilydale","Chirnside Park","Glen Waverley","Mount Waverley","Wheelers Hill","Burwood"],bounds:{latMin:-37.92,latMax:-37.7,lngMin:145.05,lngMax:145.3}},MELBOURNE_INNER:{id:"melbourne_inner",name:"Melbourne Inner",color:"#FFD93D",icon:"\uD83C\uDFD9️",description:"CBD, Carlton, Fitzroy, South Yarra, Richmond",suburbs:["Melbourne","CBD","Carlton","Fitzroy","Collingwood","Richmond","South Yarra","Prahran","St Kilda","Port Melbourne","South Melbourne","Albert Park","Middle Park","Parkville","North Melbourne","Southbank","Docklands","East Melbourne","Jolimont","Cremorne","Abbotsford"],bounds:{latMin:-37.87,latMax:-37.78,lngMin:144.93,lngMax:145.05}},SOUTH_EASTERN:{id:"south_eastern",name:"South Eastern Suburbs",color:"#6BCB77",icon:"\uD83C\uDF33",description:"Frankston, Dandenong, Cranbourne, Clayton",suburbs:["Frankston","Dandenong","Cranbourne","Mordialloc","Chelsea","Carrum","Seaford","Mentone","Parkdale","Cheltenham","Springvale","Noble Park","Keysborough","Hampton Park","Narre Warren","Berwick","Pakenham","Endeavour Hills","Hallam","Lyndhurst","Lynbrook","Clayton","Oakleigh","Malvern","Caulfield","Carnegie","Murrumbeena","Hughesdale","Bentleigh"],bounds:{latMin:-38.2,latMax:-37.82,lngMin:145,lngMax:145.3}}},r=(e,a,t)=>{if(t){let e=t.toLowerCase();for(let a of Object.values(s))if(a.suburbs.some(a=>e.includes(a.toLowerCase())))return a}for(let t of Object.values(s))if(e>=t.bounds.latMin&&e<=t.bounds.latMax&&a>=t.bounds.lngMin&&a<=t.bounds.lngMax)return t;return s.MELBOURNE_INNER}},6398:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/directory",function(){return t(2404)}])},9099:(e,a,t)=>{e.exports=t(6296)},9468:(e,a,t)=>{"use strict";t.d(a,{A:()=>o});var s=t(7876);t(4232);var r=t(8230),l=t.n(r),n=t(4e3);let i={"/":[{label:"Home",path:"/",icon:"\uD83C\uDFE0",isActive:!0}],"/directory":[{label:"Home",path:"/",icon:"\uD83C\uDFE0"},{label:"Station Directory",path:"/directory",icon:"\uD83D\uDDFA️",isActive:!0}],"/blog":[{label:"Home",path:"/",icon:"\uD83C\uDFE0"},{label:"Blog",path:"/blog",icon:"\uD83D\uDCDD",isActive:!0}],"/faq":[{label:"Home",path:"/",icon:"\uD83C\uDFE0"},{label:"FAQ",path:"/faq",icon:"❓",isActive:!0}],"/about":[{label:"Home",path:"/",icon:"\uD83C\uDFE0"},{label:"About",path:"/about",icon:"ℹ️",isActive:!0}]},o=e=>{let{customCrumbs:a}=e,t=(0,n.usePathname)(),r=a||i[t]||[{label:"Home",path:"/",icon:"\uD83C\uDFE0"}],o={"@context":"https://schema.org","@type":"BreadcrumbList",itemListElement:r.map((e,a)=>({"@type":"ListItem",position:a+1,name:e.label,item:"https://petrolpricesnearme.com.au".concat(e.path)}))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(o)}}),(0,s.jsx)("nav",{className:"breadcrumbs","aria-label":"Breadcrumb navigation",children:(0,s.jsx)("div",{className:"container",children:(0,s.jsx)("ol",{className:"breadcrumb-list",children:r.map((e,a)=>(0,s.jsxs)("li",{className:"breadcrumb-item ".concat(e.isActive?"active":""),children:[e.isActive?(0,s.jsxs)("span",{"aria-current":"page",children:[e.icon&&(0,s.jsx)("span",{className:"breadcrumb-icon","aria-hidden":"true",children:e.icon}),e.label]}):(0,s.jsxs)(l(),{href:e.path,children:[e.icon&&(0,s.jsx)("span",{className:"breadcrumb-icon","aria-hidden":"true",children:e.icon}),e.label]}),a<r.length-1&&(0,s.jsx)("span",{className:"breadcrumb-separator","aria-hidden":"true",children:"›"})]},a))})})})]})}}},e=>{e.O(0,[377,875,636,593,792],()=>e(e.s=6398)),_N_E=e.O()}]);